<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mahjong - Apprentissage du Chinois</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
            zoom: 80%;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #e94560;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .settings-panel {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .setting-group {
            display: flex;
            flex-direction: column;
            min-width: 180px;
        }

        .setting-group label {
            margin-bottom: 8px;
            font-weight: bold;
            color: #ff9a3c;
        }

        .setting-group select, .setting-group button {
            padding: 10px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #0f3460;
            color: white;
            font-size: 1em;
            cursor: pointer;
        }

        .setting-group select:hover, .setting-group button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        select option {
            background: #2d4059;
            color: white;
            padding: 10px;
        }
        
        select:focus {
            outline: none;
            border-color: #ff9a3c;
        }
        
        .game-info {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 800px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            min-width: 120px;
            text-align: center;
        }

        .level-display {
            background: linear-gradient(135deg, #e94560, #c53d54);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            min-width: 120px;
            text-align: center;
            margin-bottom: 15px;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 6px;
            margin: 0 auto;
            width: 100%;
            max-width: 800px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }

        .tile {
            aspect-ratio: 1;
            background: linear-gradient(145deg, #2d4059, #1e2a3f);
            border: 2px solid #e94560;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.6em;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            font-weight: bold;
            color: white;
        }

        .tile .pinyin {
            font-size: 0.35em;
            margin-top: 4px;
            opacity: 0.8;
            font-weight: normal;
        }

        .tile:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 20px rgba(233, 69, 96, 0.4);
            border-color: #ff9a3c;
        }

        .tile.selected {
            background: linear-gradient(145deg, #e94560, #c53d54);
            border-color: #ff9a3c;
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(233, 69, 96, 0.6);
            animation: pulse 0.6s infinite alternate;
        }

        @keyframes pulse {
            from {
                box-shadow: 0 0 20px rgba(233, 69, 96, 0.4);
            }
            to {
                box-shadow: 0 0 40px rgba(233, 69, 96, 0.8);
            }
        }

        .tile.matched {
            animation: matchAnimation 0.6s forwards;
        }

        @keyframes matchAnimation {
            0% {
                transform: scale(1.1) rotate(0deg);
            }
            50% {
                transform: scale(1.3) rotate(180deg);
                opacity: 1;
            }
            100% {
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #e94560, #c53d54);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(233, 69, 96, 0.4);
            background: linear-gradient(135deg, #ff9a3c, #e94560);
        }

        button:active {
            transform: translateY(0);
        }

        .learning-popup {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(45, 64, 89, 0.95);
            border: 2px solid #e94560;
            border-radius: 15px;
            padding: 15px 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            z-index: 1000;
            display: none;
            max-width: 90%;
        }

        .learning-popup .hanzi {
            font-size: 2.5em;
            margin-bottom: 5px;
            font-family: 'KaiTi', 'SimKai', 'STKaiti', serif;
        }

        .learning-popup .pinyin {
            font-size: 1.5em;
            color: #ff9a3c;
            margin-bottom: 8px;
        }

        .learning-popup .translation {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .learning-popup .play-sound {
            margin-top: 10px;
            background: rgba(233, 69, 96, 0.3);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin: 10px auto 0;
            transition: all 0.3s;
        }

        .learning-popup .play-sound:hover {
            background: rgba(233, 69, 96, 0.6);
            transform: scale(1.1);
        }

        .victory-message {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(45, 64, 89, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            text-align: center;
            z-index: 1000;
            border: 3px solid #e94560;
            max-width: 90%;
        }

        .victory-message h2 {
            color: #e94560;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .victory-message p {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 999;
        }

        @media (max-width: 900px) {
            body {
                zoom: 100%;
            }
            
            .game-board {
                grid-template-columns: repeat(8, 1fr);
                gap: 5px;
                padding: 10px;
            }
            
            .tile {
                font-size: 1.4em;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .info-item {
                font-size: 0.9em;
                padding: 8px 15px;
            }
            
            .settings-panel {
                flex-direction: column;
                align-items: center;
            }
            
            .setting-group {
                width: 100%;
                max-width: 250px;
            }
        }

        @media (max-width: 600px) {
            .game-board {
                grid-template-columns: repeat(8, 1fr);
                gap: 4px;
            }
            
            .tile {
                font-size: 1.1em;
                border-width: 1px;
            }
            
            .tile .pinyin {
                font-size: 0.3em;
                margin-top: 2px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            button {
                padding: 10px 15px;
                font-size: 0.9em;
            }
            
            .learning-popup {
                padding: 10px 15px;
            }
            
            .learning-popup .hanzi {
                font-size: 2em;
            }
            
            .learning-popup .pinyin {
                font-size: 1.2em;
            }
            
            .learning-popup .translation {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Mahjong - Apprentissage du Chinois</h1>
            
            <div class="settings-panel">
                <div class="setting-group">
                    <label for="languageSelect">Langue:</label>
                    <select id="languageSelect">
                        <option value="fr">FranÃ§ais</option>
                        <option value="en">English</option>
                        <option value="de">Deutsch</option>
                        <option value="it">Italiano</option>
                        <option value="es">EspaÃ±ol</option>
                        <option value="fa">ÙØ§Ø±Ø³ÛŒ</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label for="themeSelect">ThÃ¨me de vocabulaire:</label>
                    <select id="themeSelect">
                        <option value="basics">Nombres & Bases (A1)</option>
                        <option value="nature">Nature (A1)</option>
                        <option value="family">Famille (A2)</option>
                        <option value="food">Nourriture (A2)</option>
                        <option value="verbs">Verbes Communs (B1)</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label for="zoomSelect">Zoom (PC):</label>
                    <select id="zoomSelect">
                        <option value="100">100%</option>
                        <option value="90">90%</option>
                        <option value="80" selected>80%</option>
                        <option value="70">70%</option>
                        <option value="60">60%</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label>&nbsp;</label>
                    <button onclick="saveSettings()">Appliquer les paramÃ¨tres</button>
                </div>
            </div>
        </header>
        
        <div class="level-display">
            Niveau: <span id="level">A1 - DÃ©butant</span>
        </div>
        
        <div class="game-info">
            <div class="info-item">Score: <span id="score">0</span></div>
            <div class="info-item">Paires: <span id="pairs">0</span>/16</div>
            <div class="info-item">Temps: <span id="timer">00:00</span></div>
        </div>

        <div class="game-board" id="gameBoard"></div>

        <div class="controls">
            <button onclick="newGame()">Nouvelle Partie</button>
            <button onclick="hint()">Indice ğŸ’¡</button>
            <button onclick="shuffle()">MÃ©langer ğŸ”„</button>
            <button onclick="showScores()">Scores ğŸ†</button>
        </div>
    </div>

    <div class="learning-popup" id="learningPopup">
        <div class="hanzi" id="popupHanzi"></div>
        <div class="pinyin" id="popupPinyin"></div>
        <div class="translation" id="popupTranslation"></div>
        <button class="play-sound" onclick="playCurrentSound()">ğŸ”Š</button>
    </div>

    <div class="overlay" id="overlay"></div>
    
    <div class="victory-message" id="victoryMessage">
        <h2>ğŸ‰ FÃ©licitations! ğŸ‰</h2>
        <p>Vous avez terminÃ© le jeu!</p>
        <p>Score final: <span id="finalScore">0</span></p>
        <p>Niveau atteint: <span id="finalLevel">A1 - DÃ©butant</span></p>
        <p>Temps: <span id="finalTime">00:00</span></p>
        <button onclick="newGame()">Nouvelle Partie</button>
    </div>

    <script>
        // Dictionnaires de caractÃ¨res chinois par thÃ¨me
        const themes = {
            basics: {
                name: "Nombres & Bases",
                level: "A1",
                characters: [
                    { hanzi: 'ä¸€', pinyin: 'yÄ«', translations: { fr: 'un', en: 'one', de: 'eins', it: 'uno', es: 'uno', fa: 'ÛŒÚ©' } },
                    { hanzi: 'äºŒ', pinyin: 'Ã¨r', translations: { fr: 'deux', en: 'two', de: 'zwei', it: 'due', es: 'dos', fa: 'Ø¯Ùˆ' } },
                    { hanzi: 'ä¸‰', pinyin: 'sÄn', translations: { fr: 'trois', en: 'three', de: 'drei', it: 'tre', es: 'tres', fa: 'Ø³Ù‡' } },
                    { hanzi: 'å››', pinyin: 'sÃ¬', translations: { fr: 'quatre', en: 'four', de: 'vier', it: 'quattro', es: 'cuatro', fa: 'Ú†Ù‡Ø§Ø±' } },
                    { hanzi: 'äº”', pinyin: 'wÇ”', translations: { fr: 'cinq', en: 'five', de: 'fÃ¼nf', it: 'cinque', es: 'cinco', fa: 'Ù¾Ù†Ø¬' } },
                    { hanzi: 'å…­', pinyin: 'liÃ¹', translations: { fr: 'six', en: 'six', de: 'sechs', it: 'sei', es: 'seis', fa: 'Ø´Ø´' } },
                    { hanzi: 'ä¸ƒ', pinyin: 'qÄ«', translations: { fr: 'sept', en: 'seven', de: 'sieben', it: 'sette', es: 'siete', fa: 'Ù‡ÙØª' } },
                    { hanzi: 'å…«', pinyin: 'bÄ', translations: { fr: 'huit', en: 'eight', de: 'acht', it: 'otto', es: 'ocho', fa: 'Ù‡Ø´Øª' } },
                    { hanzi: 'ä¹', pinyin: 'jiÇ”', translations: { fr: 'neuf', en: 'nine', de: 'neun', it: 'nove', es: 'nueve', fa: 'Ù†Ù‡' } },
                    { hanzi: 'å', pinyin: 'shÃ­', translations: { fr: 'dix', en: 'ten', de: 'zehn', it: 'dieci', es: 'diez', fa: 'Ø¯Ù‡' } },
                    { hanzi: 'äºº', pinyin: 'rÃ©n', translations: { fr: 'personne', en: 'person', de: 'Person', it: 'persona', es: 'persona', fa: 'Ø´Ø®Øµ' } },
                    { hanzi: 'å¤§', pinyin: 'dÃ ', translations: { fr: 'grand', en: 'big', de: 'groÃŸ', it: 'grande', es: 'grande', fa: 'Ø¨Ø²Ø±Ú¯' } },
                    { hanzi: 'å°', pinyin: 'xiÇo', translations: { fr: 'petit', en: 'small', de: 'klein', it: 'piccolo', es: 'pequeÃ±o', fa: 'Ú©ÙˆÚ†Ú©' } },
                    { hanzi: 'æ—¥', pinyin: 'rÃ¬', translations: { fr: 'soleil', en: 'sun', de: 'Sonne', it: 'sole', es: 'sol', fa: 'Ø®ÙˆØ±Ø´ÛŒØ¯' } },
                    { hanzi: 'æœˆ', pinyin: 'yuÃ¨', translations: { fr: 'lune', en: 'moon', de: 'Mond', it: 'luna', es: 'luna', fa: 'Ù…Ø§Ù‡' } },
                    { hanzi: 'æ°´', pinyin: 'shuÇ', translations: { fr: 'eau', en: 'water', de: 'Wasser', it: 'acqua', es: 'agua', fa: 'Ø¢Ø¨' } }
                ]
            },
            nature: {
                name: "Nature",
                level: "A1",
                characters: [
                    { hanzi: 'å±±', pinyin: 'shÄn', translations: { fr: 'montagne', en: 'mountain', de: 'Berg', it: 'montagna', es: 'montaÃ±a', fa: 'Ú©ÙˆÙ‡' } },
                    { hanzi: 'æ°´', pinyin: 'shuÇ', translations: { fr: 'eau', en: 'water', de: 'Wasser', it: 'acqua', es: 'agua', fa: 'Ø¢Ø¨' } },
                    { hanzi: 'ç«', pinyin: 'huÇ’', translations: { fr: 'feu', en: 'fire', de: 'Feuer', it: 'fuoco', es: 'fuego', fa: 'Ø¢ØªØ´' } },
                    { hanzi: 'æœ¨', pinyin: 'mÃ¹', translations: { fr: 'bois', en: 'wood', de: 'Holz', it: 'legno', es: 'madera', fa: 'Ú†ÙˆØ¨' } },
                    { hanzi: 'çŸ³', pinyin: 'shÃ­', translations: { fr: 'pierre', en: 'stone', de: 'Stein', it: 'pietra', es: 'piedra', fa: 'Ø³Ù†Ú¯' } },
                    { hanzi: 'å¤©', pinyin: 'tiÄn', translations: { fr: 'ciel', en: 'sky', de: 'Himmel', it: 'cielo', es: 'cielo', fa: 'Ø¢Ø³Ù…Ø§Ù†' } },
                    { hanzi: 'åœ°', pinyin: 'dÃ¬', translations: { fr: 'terre', en: 'earth', de: 'Erde', it: 'terra', es: 'tierra', fa: 'Ø²Ù…ÛŒÙ†' } },
                    { hanzi: 'é£', pinyin: 'fÄ“ng', translations: { fr: 'vent', en: 'wind', de: 'Wind', it: 'vento', es: 'viento', fa: 'Ø¨Ø§Ø¯' } },
                    { hanzi: 'é›¨', pinyin: 'yÇ”', translations: { fr: 'pluie', en: 'rain', de: 'Regen', it: 'pioggia', es: 'lluvia', fa: 'Ø¨Ø§Ø±Ø§Ù†' } },
                    { hanzi: 'äº‘', pinyin: 'yÃºn', translations: { fr: 'nuage', en: 'cloud', de: 'Wolke', it: 'nuvola', es: 'nube', fa: 'Ø§Ø¨Ø±' } },
                    { hanzi: 'èŠ±', pinyin: 'huÄ', translations: { fr: 'fleur', en: 'flower', de: 'Blume', it: 'fiore', es: 'flor', fa: 'Ú¯Ù„' } },
                    { hanzi: 'è‰', pinyin: 'cÇo', translations: { fr: 'herbe', en: 'grass', de: 'Gras', it: 'erba', es: 'hierba', fa: 'Ú†Ù…Ù†' } },
                    { hanzi: 'æ ‘', pinyin: 'shÃ¹', translations: { fr: 'arbre', en: 'tree', de: 'Baum', it: 'albero', es: 'Ã¡rbol', fa: 'Ø¯Ø±Ø®Øª' } },
                    { hanzi: 'é±¼', pinyin: 'yÃº', translations: { fr: 'poisson', en: 'fish', de: 'Fisch', it: 'pesce', es: 'pez', fa: 'Ù…Ø§Ù‡ÛŒ' } },
                    { hanzi: 'é¸Ÿ', pinyin: 'niÇo', translations: { fr: 'oiseau', en: 'bird', de: 'Vogel', it: 'uccello', es: 'pÃ¡jaro', fa: 'Ù¾Ø±Ù†Ø¯Ù‡' } },
                    { hanzi: 'è™«', pinyin: 'chÃ³ng', translations: { fr: 'insecte', en: 'insect', de: 'Insekt', it: 'insetto', es: 'insecto', fa: 'Ø­Ø´Ø±Ù‡' } }
                ]
            },
            family: {
                name: "Famille",
                level: "A2",
                characters: [
                    { hanzi: 'å®¶', pinyin: 'jiÄ', translations: { fr: 'famille', en: 'family', de: 'Familie', it: 'famiglia', es: 'familia', fa: 'Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡' } },
                    { hanzi: 'çˆ¶', pinyin: 'fÃ¹', translations: { fr: 'pÃ¨re', en: 'father', de: 'Vater', it: 'padre', es: 'padre', fa: 'Ù¾Ø¯Ø±' } },
                    { hanzi: 'æ¯', pinyin: 'mÇ”', translations: { fr: 'mÃ¨re', en: 'mother', de: 'Mutter', it: 'madre', es: 'madre', fa: 'Ù…Ø§Ø¯Ø±' } },
                    { hanzi: 'å„¿', pinyin: 'Ã©r', translations: { fr: 'enfant', en: 'child', de: 'Kind', it: 'bambino', es: 'niÃ±o', fa: 'Ú©ÙˆØ¯Ú©' } },
                    { hanzi: 'å­', pinyin: 'zÇ', translations: { fr: 'fils', en: 'son', de: 'Sohn', it: 'figlio', es: 'hijo', fa: 'Ù¾Ø³Ø±' } },
                    { hanzi: 'å¥³', pinyin: 'nÇš', translations: { fr: 'fille', en: 'daughter', de: 'Tochter', it: 'figlia', es: 'hija', fa: 'Ø¯Ø®ØªØ±' } },
                    { hanzi: 'å…„', pinyin: 'xiÅng', translations: { fr: 'frÃ¨re aÃ®nÃ©', en: 'older brother', de: 'Ã¤lterer Bruder', it: 'fratello maggiore', es: 'hermano mayor', fa: 'Ø¨Ø±Ø§Ø¯Ø± Ø¨Ø²Ø±Ú¯ØªØ±' } },
                    { hanzi: 'å¼Ÿ', pinyin: 'dÃ¬', translations: { fr: 'frÃ¨re cadet', en: 'younger brother', de: 'jÃ¼ngerer Bruder', it: 'fratello minore', es: 'hermano menor', fa: 'Ø¨Ø±Ø§Ø¯Ø± Ú©ÙˆÚ†Ú©ØªØ±' } },
                    { hanzi: 'å§', pinyin: 'jiÄ›', translations: { fr: 'sÅ“ur aÃ®nÃ©e', en: 'older sister', de: 'Ã¤ltere Schwester', it: 'sorella maggiore', es: 'hermana mayor', fa: 'Ø®ÙˆØ§Ù‡Ø± Ø¨Ø²Ø±Ú¯ØªØ±' } },
                    { hanzi: 'å¦¹', pinyin: 'mÃ¨i', translations: { fr: 'sÅ“ur cadette', en: 'younger sister', de: 'jÃ¼ngere Schwester', it: 'sorella minore', es: 'hermana menor', fa: 'Ø®ÙˆØ§Ù‡Ø± Ú©ÙˆÚ†Ú©ØªØ±' } },
                    { hanzi: 'å¤«', pinyin: 'fÅ«', translations: { fr: 'mari', en: 'husband', de: 'Ehemann', it: 'marito', es: 'esposo', fa: 'Ø´ÙˆÙ‡Ø±' } },
                    { hanzi: 'å¦»', pinyin: 'qÄ«', translations: { fr: 'Ã©pouse', en: 'wife', de: 'Ehefrau', it: 'moglie', es: 'esposa', fa: 'Ù‡Ù…Ø³Ø±' } },
                    { hanzi: 'ç”·', pinyin: 'nÃ¡n', translations: { fr: 'homme', en: 'man', de: 'Mann', it: 'uomo', es: 'hombre', fa: 'Ù…Ø±Ø¯' } },
                    { hanzi: 'å¥³', pinyin: 'nÇš', translations: { fr: 'femme', en: 'woman', de: 'Frau', it: 'femme', es: 'mujer', fa: 'Ø²Ù†' } },
                    { hanzi: 'å­©', pinyin: 'hÃ¡i', translations: { fr: 'enfant', en: 'child', de: 'Kind', it: 'enfant', es: 'niÃ±o', fa: 'Ú©ÙˆØ¯Ú©' } },
                    { hanzi: 'æœ‹', pinyin: 'pÃ©ng', translations: { fr: 'ami', en: 'friend', de: 'Freund', it: 'ami', es: 'amigo', fa: 'Ø¯ÙˆØ³Øª' } }
                ]
            },
            food: {
                name: "Nourriture",
                level: "A2",
                characters: [
                    { hanzi: 'é£Ÿ', pinyin: 'shÃ­', translations: { fr: 'nourriture', en: 'food', de: 'Essen', it: 'cibo', es: 'comida', fa: 'ØºØ°Ø§' } },
                    { hanzi: 'ç±³', pinyin: 'mÇ', translations: { fr: 'riz', en: 'rice', de: 'Reis', it: 'riso', es: 'arroz', fa: 'Ø¨Ø±Ù†Ø¬' } },
                    { hanzi: 'é¢', pinyin: 'miÃ n', translations: { fr: 'nouilles', en: 'noodles', de: 'Nudeln', it: 'noodles', es: 'fideos', fa: 'Ù†ÙˆØ¯Ù„' } },
                    { hanzi: 'è‚‰', pinyin: 'rÃ²u', translations: { fr: 'viande', en: 'meat', de: 'Fleisch', it: 'carne', es: 'carne', fa: 'Ú¯ÙˆØ´Øª' } },
                    { hanzi: 'é±¼', pinyin: 'yÃº', translations: { fr: 'poisson', en: 'fish', de: 'Fisch', it: 'pesce', es: 'pescado', fa: 'Ù…Ø§Ù‡ÛŒ' } },
                    { hanzi: 'é¸¡', pinyin: 'jÄ«', translations: { fr: 'poulet', en: 'chicken', de: 'Huhn', it: 'pollo', es: 'pollo', fa: 'Ù…Ø±Øº' } },
                    { hanzi: 'ç‰›', pinyin: 'niÃº', translations: { fr: 'bÅ“uf', en: 'beef', de: 'Rind', it: 'manzo', es: 'res', fa: 'Ú¯Ø§Ùˆ' } },
                    { hanzi: 'çŒª', pinyin: 'zhÅ«', translations: { fr: 'porc', en: 'pork', de: 'Schwein', it: 'maiale', es: 'cerdo', fa: 'Ø®ÙˆÚ©' } },
                    { hanzi: 'èœ', pinyin: 'cÃ i', translations: { fr: 'lÃ©gume', en: 'vegetable', de: 'GemÃ¼se', it: 'verdura', es: 'verdura', fa: 'Ø³Ø¨Ø²ÛŒ' } },
                    { hanzi: 'æœ', pinyin: 'guÇ’', translations: { fr: 'fruit', en: 'fruit', de: 'Frucht', it: 'frutta', es: 'fruta', fa: 'Ù…ÛŒÙˆÙ‡' } },
                    { hanzi: 'èŒ¶', pinyin: 'chÃ¡', translations: { fr: 'thÃ©', en: 'tea', de: 'Tee', it: 'tÃ¨', es: 'tÃ©', fa: 'Ú†Ø§ÛŒ' } },
                    { hanzi: 'æ°´', pinyin: 'shuÇ', translations: { fr: 'eau', en: 'water', de: 'Wasser', it: 'acqua', es: 'agua', fa: 'Ø¢Ø¨' } },
                    { hanzi: 'é…’', pinyin: 'jiÇ”', translations: { fr: 'alcool', en: 'alcohol', de: 'Alkohol', it: 'alcol', es: 'alcohol', fa: 'Ø§Ù„Ú©Ù„' } },
                    { hanzi: 'é¥­', pinyin: 'fÃ n', translations: { fr: 'repas', en: 'meal', de: 'Mahlzeit', it: 'pasto', es: 'comida', fa: 'ØºØ°Ø§' } },
                    { hanzi: 'æ±¤', pinyin: 'tÄng', translations: { fr: 'soupe', en: 'soup', de: 'Suppe', it: 'zuppa', es: 'sopa', fa: 'Ø³ÙˆÙ¾' } },
                    { hanzi: 'è›‹', pinyin: 'dÃ n', translations: { fr: 'Å“uf', en: 'egg', de: 'Ei', it: 'uovo', es: 'huevo', fa: 'ØªØ®Ù… Ù…Ø±Øº' } }
                ]
            },
            verbs: {
                name: "Verbes Communs",
                level: "B1",
                characters: [
                    { hanzi: 'æ˜¯', pinyin: 'shÃ¬', translations: { fr: 'Ãªtre', en: 'to be', de: 'sein', it: 'essere', es: 'ser', fa: 'Ø¨ÙˆØ¯Ù†' } },
                    { hanzi: 'æœ‰', pinyin: 'yÇ’u', translations: { fr: 'avoir', en: 'to have', de: 'haben', it: 'avere', es: 'tener', fa: 'Ø¯Ø§Ø´ØªÙ†' } },
                    { hanzi: 'åš', pinyin: 'zuÃ²', translations: { fr: 'faire', en: 'to do', de: 'tun', it: 'fare', es: 'hacer', fa: 'Ø§Ù†Ø¬Ø§Ù… Ø¯Ø§Ø¯Ù†' } },
                    { hanzi: 'å»', pinyin: 'qÃ¹', translations: { fr: 'aller', en: 'to go', de: 'gehen', it: 'andare', es: 'ir', fa: 'Ø±ÙØªÙ†' } },
                    { hanzi: 'æ¥', pinyin: 'lÃ¡i', translations: { fr: 'venir', en: 'to come', de: 'kommen', it: 'venire', es: 'venir', fa: 'Ø¢Ù…Ø¯Ù†' } },
                    { hanzi: 'è¯´', pinyin: 'shuÅ', translations: { fr: 'parler', en: 'to speak', de: 'sprechen', it: 'parlare', es: 'hablar', fa: 'ØµØ­Ø¨Øª Ú©Ø±Ø¯Ù†' } },
                    { hanzi: 'çœ‹', pinyin: 'kÃ n', translations: { fr: 'regarder', en: 'to look', de: 'schauen', it: 'guardare', es: 'mirar', fa: 'Ù†Ú¯Ø§Ù‡ Ú©Ø±Ø¯Ù†' } },
                    { hanzi: 'å¬', pinyin: 'tÄ«ng', translations: { fr: 'Ã©couter', en: 'to listen', de: 'hÃ¶ren', it: 'ascoltare', es: 'escuchar', fa: 'Ø´Ù†ÛŒØ¯Ù†' } },
                    { hanzi: 'è¯»', pinyin: 'dÃº', translations: { fr: 'lire', en: 'to read', de: 'lesen', it: 'leggere', es: 'leer', fa: 'Ø®ÙˆØ§Ù†Ø¯Ù†' } },
                    { hanzi: 'å†™', pinyin: 'xiÄ›', translations: { fr: 'Ã©crire', en: 'to write', de: 'schreiben', it: 'scrivere', es: 'escribir', fa: 'Ù†ÙˆØ´ØªÙ†' } },
                    { hanzi: 'å­¦', pinyin: 'xuÃ©', translations: { fr: 'Ã©tudier', en: 'to study', de: 'lernen', it: 'studiare', es: 'estudiar', fa: 'Ø®ÙˆØ§Ù†Ø¯Ù†' } },
                    { hanzi: 'ä¹°', pinyin: 'mÇi', translations: { fr: 'acheter', en: 'to buy', de: 'kaufen', it: 'comprare', es: 'comprar', fa: 'Ø®Ø±ÛŒØ¯Ù†' } },
                    { hanzi: 'å–', pinyin: 'mÃ i', translations: { fr: 'vendre', en: 'to sell', de: 'verkaufen', it: 'vendere', es: 'vender', fa: 'ÙØ±ÙˆØ´' } },
                    { hanzi: 'åƒ', pinyin: 'chÄ«', translations: { fr: 'manger', en: 'to eat', de: 'essen', it: 'mangiare', es: 'comer', fa: 'Ø®ÙˆØ±Ø¯Ù†' } },
                    { hanzi: 'å–', pinyin: 'hÄ“', translations: { fr: 'boire', en: 'to drink', de: 'trinken', it: 'bere', es: 'beber', fa: 'Ù†ÙˆØ´ÛŒØ¯Ù†' } },
                    { hanzi: 'çˆ±', pinyin: 'Ã i', translations: { fr: 'aimer', en: 'to love', de: 'lieben', it: 'amare', es: 'amar', fa: 'Ø¯OST Ø¯Ø§Ø´ØªÙ†' } }
                ]
            }
        };

        // SystÃ¨me de niveaux
        const levels = [
            { threshold: 0, name: { fr: "A1 - DÃ©butant", en: "A1 - Beginner", de: "A1 - AnfÃ¤nger", it: "A1 - Principiante", es: "A1 - Principiante", fa: "A1 - Ø´Ø±ÙˆØ¹" } },
            { threshold: 500, name: { fr: "A2 - Ã‰lÃ©mentaire", en: "A2 - Elementary", de: "A2 - Grundlagen", it: "A2 - Elementare", es: "A2 - Elemental", fa: "A2 - Ù…Ù‚Ø¯Ù…Ø§ØªÛŒ" } },
            { threshold: 1000, name: { fr: "B1 - IntermÃ©diaire", en: "B1 - Intermediate", de: "B1 - Mittelstufe", it: "B1 - Intermedio", es: "B1 - Intermedio", fa: "B1 - Ù…ØªÙˆØ³Ø·" } },
            { threshold: 1500, name: { fr: "B2 - IntermÃ©diaire supÃ©rieur", en: "B2 - Upper Intermediate", de: "B2 - Fortgeschritten", it: "B2 - Intermedio Superiore", es: "B2 - Intermedio Alto", fa: "B2 - ÙÙˆÙ‚ Ù…ØªÙˆØ³Ø·" } },
            { threshold: 2000, name: { fr: "C1 - AvancÃ©", en: "C1 - Advanced", de: "C1 - Sehr Fortgeschritten", it: "C1 - Avanzato", es: "C1 - Avanzado", fa: "C1 - Ù¾ÛŒØ´Ø±ÙØªÙ‡" } },
            { threshold: 2500, name: { fr: "C2 - MaÃ®trise", en: "C2 - Mastery", de: "C2 - Beherrschung", it: "C2 - Padronanza", es: "C2 - MaestrÃ­a", fa: "C2 - ØªØ³Ù„Ø·" } }
        ];

        let currentTheme = 'basics';
        let currentLanguage = 'fr';
        let gameBoard = [];
        let selectedTile = null;
        let score = 0;
        let matchedPairs = 0;
        let totalPairs = 16;
        let startTime = null;
        let timerInterval = null;
        let isProcessing = false;
        let currentSound = null;
        let timeElapsed = 0;

        // Initialisation du jeu
        function initGame() {
            loadSettings();
            updateUITexts();
            newGame();
            
            // Ajouter les Ã©couteurs d'Ã©vÃ©nements
            document.getElementById('languageSelect').addEventListener('change', function() {
                currentLanguage = this.value;
                updateUITexts();
                updateLevelDisplay();
            });
            
            document.getElementById('themeSelect').addEventListener('change', function() {
                currentTheme = this.value;
                newGame();
            });
            
            document.getElementById('zoomSelect').addEventListener('change', function() {
                document.body.style.zoom = this.value + '%';
            });
        }

        // Charger les paramÃ¨tres depuis le localStorage
        function loadSettings() {
            const savedLanguage = localStorage.getItem('chineseMahjongLanguage');
            const savedZoom = localStorage.getItem('chineseMahjongZoom');
            const savedTheme = localStorage.getItem('chineseMahjongTheme');
            
            if (savedLanguage) {
                currentLanguage = savedLanguage;
                document.getElementById('languageSelect').value = currentLanguage;
            }
            
            if (savedZoom) {
                document.body.style.zoom = savedZoom + '%';
                document.getElementById('zoomSelect').value = savedZoom;
            }
            
            if (savedTheme) {
                currentTheme = savedTheme;
                document.getElementById('themeSelect').value = currentTheme;
            }
        }

        // Sauvegarder les paramÃ¨tres dans le localStorage
        function saveSettings() {
            const language = document.getElementById('languageSelect').value;
            const zoom = document.getElementById('zoomSelect').value;
            const theme = document.getElementById('themeSelect').value;
            
            localStorage.setItem('chineseMahjongLanguage', language);
            localStorage.setItem('chineseMahjongZoom', zoom);
            localStorage.setItem('chineseMahjongTheme', theme);
            
            currentLanguage = language;
            currentTheme = theme;
            document.body.style.zoom = zoom + '%';
            
            updateUITexts();
            updateLevelDisplay();
            
            // RedÃ©marrer le jeu avec les nouveaux paramÃ¨tres
            newGame();
            
            alert("ParamÃ¨tres sauvegardÃ©s avec succÃ¨s!");
        }

        // Mise Ã  jour des textes de l'interface
        function updateUITexts() {
            const translations = {
                fr: {
                    score: "Score",
                    pairs: "Paires",
                    time: "Temps",
                    newGame: "Nouvelle Partie",
                    hint: "Indice ğŸ’¡",
                    shuffle: "MÃ©langer ğŸ”„",
                    victory: "ğŸ‰ FÃ©licitations! ğŸ‰",
                    completed: "Vous avez terminÃ© le jeu!",
                    finalScore: "Score final",
                    finalLevel: "Niveau atteint",
                    finalTime: "Temps",
                    scores: "Scores ğŸ†",
                    language: "Langue:",
                    theme: "ThÃ¨me de vocabulaire:",
                    zoom: "Zoom (PC):",
                    apply: "Appliquer les paramÃ¨tres"
                },
                en: {
                    score: "Score",
                    pairs: "Pairs",
                    time: "Time",
                    newGame: "New Game",
                    hint: "Hint ğŸ’¡",
                    shuffle: "Shuffle ğŸ”„",
                    victory: "ğŸ‰ Congratulations! ğŸ‰",
                    completed: "You completed the game!",
                    finalScore: "Final score",
                    finalLevel: "Level reached",
                    finalTime: "Time",
                    scores: "Scores ğŸ†",
                    language: "Language:",
                    theme: "Vocabulary theme:",
                    zoom: "Zoom (PC):",
                    apply: "Apply settings"
                },
                de: {
                    score: "Punkte",
                    pairs: "Paare",
                    time: "Zeit",
                    newGame: "Neues Spiel",
                    hint: "Hinweis ğŸ’¡",
                    shuffle: "Mischen ğŸ”„",
                    victory: "ğŸ‰ GlÃ¼ckwunsch! ğŸ‰",
                    completed: "Sie haben das Spiel beendet!",
                    finalScore: "Endstand",
                    finalLevel: "Erreichtes Level",
                    finalTime: "Zeit",
                    scores: "Ergebnisse ğŸ†",
                    language: "Sprache:",
                    theme: "Wortschatz-Thema:",
                    zoom: "Zoom (PC):",
                    apply: "Einstellungen anwenden"
                },
                it: {
                    score: "Punteggio",
                    pairs: "Coppie",
                    time: "Tempo",
                    newGame: "Nuova Partita",
                    hint: "Suggerimento ğŸ’¡",
                    shuffle: "Mescola ğŸ”„",
                    victory: "ğŸ‰ Congratulazioni! ğŸ‰",
                    completed: "Hai completato il gioco!",
                    finalScore: "Punteggio finale",
                    finalLevel: "Livello raggiunto",
                    finalTime: "Tempo",
                    scores: "Punteggi ğŸ†",
                    language: "Lingua:",
                    theme: "Tema vocabolario:",
                    zoom: "Zoom (PC):",
                    apply: "Applica impostazioni"
                },
                es: {
                    score: "PuntuaciÃ³n",
                    pairs: "Pares",
                    time: "Tiempo",
                    newGame: "Nuevo Juego",
                    hint: "Pista ğŸ’¡",
                    shuffle: "Barajar ğŸ”„",
                    victory: "ğŸ‰ Â¡Felicidades! ğŸ‰",
                    completed: "Â¡Has completado el juego!",
                    finalScore: "PuntuaciÃ³n final",
                    finalLevel: "Nivel alcanzado",
                    finalTime: "Tiempo",
                    scores: "Puntuaciones ğŸ†",
                    language: "Idioma:",
                    theme: "Tema de vocabulario:",
                    zoom: "Zoom (PC):",
                    apply: "Aplicar configuraciÃ³n"
                },
                fa: {
                    score: "Ø§Ù…ØªÛŒØ§Ø²",
                    pairs: "Ø¬ÙØª Ù‡Ø§",
                    time: "Ø²Ù…Ø§Ù†",
                    newGame: "Ø¨Ø§Ø²ÛŒ Ø¬Ø¯ÛŒØ¯",
                    hint: "Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ ğŸ’¡",
                    shuffle: "Ø¨Ø±Ø²Ø¯Ù† ğŸ”„",
                    victory: "ğŸ‰ ØªØ¨Ø±ÛŒÚ©! ğŸ‰",
                    completed: "Ø´Ù…Ø§ Ø¨Ø§Ø²ÛŒ Ø±Ø§ ØªÚ©Ù…ÛŒÙ„ Ú©Ø±Ø¯ÛŒØ¯!",
                    finalScore: "Ø§Ù…ØªÛŒØ§Ø² Ù†Ù‡Ø§ÛŒÛŒ",
                    finalLevel: "Ø³Ø·Ø­ Ø±Ø³ÛŒØ¯Ù‡",
                    finalTime: "Ø²Ù…Ø§Ù†",
                    scores: "Ø§Ù…ØªÛŒØ§Ø²Ø§Øª ğŸ†",
                    language: "Ø²Ø¨Ø§Ù†:",
                    theme: "ØªÙ… ÙˆØ§Ú˜Ú¯Ø§Ù†:",
                    zoom: "Ø²ÙˆÙ… (PC):",
                    apply: "Ø§Ø¹Ù…Ø§Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª"
                }
            };

            const lang = translations[currentLanguage];
            document.querySelectorAll('.info-item')[0].innerHTML = `${lang.score}: <span id="score">0</span>`;
            document.querySelectorAll('.info-item')[1].innerHTML = `${lang.pairs}: <span id="pairs">0</span>/16`;
            document.querySelectorAll('.info-item')[2].innerHTML = `${lang.time}: <span id="timer">00:00</span>`;
            
            document.querySelectorAll('button')[0].textContent = lang.newGame;
            document.querySelectorAll('button')[1].textContent = lang.hint;
            document.querySelectorAll('button')[2].textContent = lang.shuffle;
            document.querySelectorAll('button')[3].textContent = lang.scores;
            document.querySelectorAll('button')[4].textContent = lang.apply;
            
            document.querySelector('label[for="languageSelect"]').textContent = lang.language;
            document.querySelector('label[for="themeSelect"]').textContent = lang.theme;
            document.querySelector('label[for="zoomSelect"]').textContent = lang.zoom;
            
            document.getElementById('victoryMessage').querySelector('h2').textContent = lang.victory;
            document.getElementById('victoryMessage').querySelectorAll('p')[0].textContent = lang.completed;
            document.getElementById('victoryMessage').querySelectorAll('p')[1].innerHTML = `${lang.finalScore}: <span id="finalScore">0</span>`;
            document.getElementById('victoryMessage').querySelectorAll('p')[2].innerHTML = `${lang.finalLevel}: <span id="finalLevel">A1 - DÃ©butant</span>`;
            document.getElementById('victoryMessage').querySelectorAll('p')[3].innerHTML = `${lang.finalTime}: <span id="finalTime">00:00</span>`;
        }

        // Mise Ã  jour de l'affichage du niveau
        function updateLevelDisplay() {
            const currentLevel = getCurrentLevel();
            document.getElementById('level').textContent = currentLevel.name[currentLanguage];
        }

        // Obtenir le niveau actuel en fonction du score
        function getCurrentLevel() {
            for (let i = levels.length - 1; i >= 0; i--) {
                if (score >= levels[i].threshold) {
                    return levels[i];
                }
            }
            return levels[0];
        }

        // CrÃ©ation du plateau de jeu
        function createBoard() {
            const boardElement = document.getElementById('gameBoard');
            boardElement.innerHTML = '';
            gameBoard = [];
            
            const themeData = themes[currentTheme];
            let tiles = [];
            
            // CrÃ©er exactement 2 tuiles pour chaque caractÃ¨re (16 paires)
            themeData.characters.forEach(char => {
                tiles.push(char, char);
            });
            
            // MÃ©langer les tuiles
            tiles = shuffleArray(tiles);
            
            // CrÃ©er les Ã©lÃ©ments DOM
            tiles.forEach((char, index) => {
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.innerHTML = `<div>${char.hanzi}</div><div class="pinyin">${char.pinyin}</div>`;
                tile.dataset.index = index;
                tile.dataset.hanzi = char.hanzi;
                tile.dataset.pinyin = char.pinyin;
                tile.addEventListener('click', () => selectTile(tile));
                boardElement.appendChild(tile);
                gameBoard.push({element: tile, char: char, matched: false});
            });
            
            updateInfo();
            updateLevelDisplay();
        }

        // MÃ©langer un tableau
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // SÃ©lection d'une tuile
        function selectTile(tile) {
            if (isProcessing) return;
            if (tile.classList.contains('matched')) return;
            if (tile === selectedTile) {
                tile.classList.remove('selected');
                selectedTile = null;
                return;
            }
            
            if (!selectedTile) {
                selectedTile = tile;
                tile.classList.add('selected');
            } else {
                checkMatch(selectedTile, tile);
            }
        }

        // VÃ©rification de correspondance
        function checkMatch(tile1, tile2) {
            isProcessing = true;
            tile2.classList.add('selected');
            
            setTimeout(() => {
                if (tile1.dataset.hanzi === tile2.dataset.hanzi) {
                    // Match trouvÃ©!
                    tile1.classList.add('matched');
                    tile2.classList.add('matched');
                    tile1.classList.remove('selected');
                    tile2.classList.remove('selected');
                    
                    // Calcul du score basÃ© sur le temps
                    const timeBonus = Math.max(100, 500 - Math.floor(timeElapsed / 10));
                    score += timeBonus;
                    matchedPairs++;
                    
                    // Afficher l'information d'apprentissage
                    showLearningInfo(tile1.dataset.hanzi, tile1.dataset.pinyin);
                    
                    // Prononcer le caractÃ¨re
                    playSound(tile1.dataset.hanzi);
                    
                    // Retirer les tuiles aprÃ¨s l'animation
                    setTimeout(() => {
                        tile1.style.visibility = 'hidden';
                        tile2.style.visibility = 'hidden';
                    }, 600);
                    
                    updateInfo();
                    updateLevelDisplay();
                    
                    if (matchedPairs === totalPairs) {
                        victory();
                    }
                } else {
                    // Pas de match
                    tile1.classList.remove('selected');
                    tile2.classList.remove('selected');
                    // Pas de pÃ©nalitÃ© de score, seulement le temps compte
                    updateInfo();
                    updateLevelDisplay();
                }
                
                selectedTile = null;
                isProcessing = false;
            }, 500);
        }

        // Afficher l'information d'apprentissage
        function showLearningInfo(hanzi, pinyin) {
            const themeData = themes[currentTheme];
            const charInfo = themeData.characters.find(c => c.hanzi === hanzi);
            if (!charInfo) return;
            
            document.getElementById('popupHanzi').textContent = hanzi;
            document.getElementById('popupPinyin').textContent = pinyin;
            document.getElementById('popupTranslation').textContent = charInfo.translations[currentLanguage];
            
            const popup = document.getElementById('learningPopup');
            popup.style.display = 'block';
            
            // Masquer la popup aprÃ¨s 5 secondes
            setTimeout(() => {
                popup.style.display = 'none';
            }, 5000);
            
            // Stocker les informations pour la lecture audio
            currentSound = hanzi;
        }

        // Jouer le son du caractÃ¨re
        function playSound(hanzi) {
            // Utilisation de l'API Web Speech pour la synthÃ¨se vocale
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(hanzi);
                utterance.lang = 'zh-CN';
                window.speechSynthesis.speak(utterance);
            }
        }

        // Rejouer le son actuel
        function playCurrentSound() {
            if (currentSound) {
                playSound(currentSound);
            }
        }

        // Mise Ã  jour des informations du jeu
        function updateInfo() {
            document.getElementById('score').textContent = score;
            document.getElementById('pairs').textContent = matchedPairs;
        }

        // DÃ©marrer le timer
        function startTimer() {
            startTime = Date.now();
            timeElapsed = 0;
            timerInterval = setInterval(() => {
                timeElapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(timeElapsed / 60);
                const seconds = timeElapsed % 60;
                document.getElementById('timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // ArrÃªter le timer
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        // Nouvelle partie
        function newGame() {
            stopTimer();
            score = 0;
            matchedPairs = 0;
            selectedTile = null;
            isProcessing = false;
            
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('victoryMessage').style.display = 'none';
            document.getElementById('learningPopup').style.display = 'none';
            
            createBoard();
            startTimer();
        }

        // Indice
        function hint() {
            if (isProcessing) return;
            
            const unmatchedTiles = gameBoard.filter(t => 
                !t.element.classList.contains('matched')
            );
            
            if (unmatchedTiles.length < 2) return;
            
            // Trouver deux tuiles avec le mÃªme caractÃ¨re
            for (let i = 0; i < unmatchedTiles.length; i++) {
                for (let j = i + 1; j < unmatchedTiles.length; j++) {
                    if (unmatchedTiles[i].char.hanzi === unmatchedTiles[j].char.hanzi) {
                        // Faire clignoter les tuiles
                        unmatchedTiles[i].element.style.background = 'linear-gradient(145deg, #ff9a3c, #ff7c00)';
                        unmatchedTiles[j].element.style.background = 'linear-gradient(145deg, ' + 
                            '#ff9a3c, #ff7c00)';
                        
                        setTimeout(() => {
                            unmatchedTiles[i].element.style.background = '';
                            unmatchedTiles[j].element.style.background = '';
                        }, 1000);
                        
                        // Pas de pÃ©nalitÃ© de score
                        updateInfo();
                        updateLevelDisplay();
                        return;
                    }
                }
            }
        }

        // MÃ©langer les tuiles
        function shuffle() {
            if (isProcessing) return;
            
            // Sauvegarder les textes originaux des boutons
            const buttonTexts = [];
            document.querySelectorAll('.controls button').forEach(button => {
                buttonTexts.push(button.textContent);
            });
            
            const unmatchedTiles = gameBoard.filter(t => 
                !t.element.classList.contains('matched')
            );
            
            if (unmatchedTiles.length < 2) return;
            
            // Collecter les caractÃ¨res des tuiles non matchÃ©es
            let chars = unmatchedTiles.map(t => t.char);
            chars = shuffleArray(chars);
            
            // RÃ©assigner les caractÃ¨res
            unmatchedTiles.forEach((tile, index) => {
                tile.char = chars[index];
                tile.element.dataset.hanzi = chars[index].hanzi;
                tile.element.dataset.pinyin = chars[index].pinyin;
                tile.element.innerHTML = `<div>${chars[index].hanzi}</div><div class="pinyin">${chars[index].pinyin}</div>`;
            });
            
            // Restaurer les textes des boutons
            document.querySelectorAll('.controls button').forEach((button, index) => {
                button.textContent = buttonTexts[index];
            });
            
            // Pas de pÃ©nalitÃ© de score
            updateInfo();
            updateLevelDisplay();
        }
        // Victoire
        function victory() {
            stopTimer();
            const currentLevel = getCurrentLevel();
            
            // Sauvegarder le score
            saveScore(score, currentTheme, timeElapsed);
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalLevel').textContent = currentLevel.name[currentLanguage];
            document.getElementById('finalTime').textContent = document.getElementById('timer').textContent;
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('victoryMessage').style.display = 'block';
        }

        // Sauvegarder le score dans le localStorage
        function saveScore(score, theme, time) {
            const scores = JSON.parse(localStorage.getItem('chineseMahjongScores')) || [];
            const themeData = themes[theme];
            
            scores.push({
                score: score,
                theme: theme,
                themeName: themeData.name,
                level: themeData.level,
                time: time,
                date: new Date().toISOString(),
                language: currentLanguage
            });
            
            // Trier par score dÃ©croissant et garder les 10 meilleurs
            scores.sort((a, b) => b.score - a.score);
            const topScores = scores.slice(0, 10);
            
            localStorage.setItem('chineseMahjongScores', JSON.stringify(topScores));
        }

        // Afficher les scores
        function showScores() {
            const scores = JSON.parse(localStorage.getItem('chineseMahjongScores')) || [];
            let message = "Meilleurs scores:\n\n";
            
            if (scores.length === 0) {
                message += "Aucun score enregistrÃ©.";
            } else {
                scores.forEach((score, index) => {
                    const date = new Date(score.date).toLocaleDateString();
                    message += `${index + 1}. ${score.score} pts - ${score.themeName} (${score.level}) - ${score.time}s - ${date}\n`;
                });
            }
            
            alert(message);
        }

        // Initialiser le jeu au chargement
        window.onload = initGame;
    </script>
</body>
</html>
